<!doctype html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
<link href="//cdn.bootcss.com/pace/1.0.2/themes/pink/pace-theme-flash.css" rel="stylesheet">
<style>
    .pace .pace-progress {
        background: #555; /*进度条颜色*/
        height: 2px;
    }
    .pace .pace-progress-inner {
         box-shadow: 0 0 10px #555, 0 0 5px     #1E92FB; /*阴影颜色*/
    }
    .pace .pace-activity {
        border-top-color: #555;    /*上边框颜色*/
        border-left-color: #555;    /*左边框颜色*/
    }
</style>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="android,基础," />








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.1" />






<meta name="description" content="参考：Android 四大组件 参考：开发艺术探索书籍 Activity 生命周期 正常启动流程：  onCreate() —— onStart() —— onResume()  正常销毁流程：  onPause() —— onStop() —— onDestroy() 操作情况： 1.处于 onResume() 的时候，用户按 Home 键或锁屏或打开新界面时，导致界面不可见，会回调 onPau">
<meta name="keywords" content="android,基础">
<meta property="og:type" content="article">
<meta property="og:title" content="四大组件之Activity">
<meta property="og:url" content="http://yoursite.com/2018/11/28/android/base/四大组件之Activity/index.html">
<meta property="og:site_name" content="FandaCode">
<meta property="og:description" content="参考：Android 四大组件 参考：开发艺术探索书籍 Activity 生命周期 正常启动流程：  onCreate() —— onStart() —— onResume()  正常销毁流程：  onPause() —— onStop() —— onDestroy() 操作情况： 1.处于 onResume() 的时候，用户按 Home 键或锁屏或打开新界面时，导致界面不可见，会回调 onPau">
<meta property="og:image" content="https://cl.ly/160503654da8/Activity%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.jpg">
<meta property="og:image" content="https://cl.ly/6c1701ef073d/Activity%E5%92%8CFragment%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%85%B3%E7%B3%BB.png">
<meta property="og:image" content="https://cl.ly/f99b84656e1d/Activity%E4%B8%8EFragment%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%80.jpg">
<meta property="og:image" content="https://cl.ly/a8180a2dd6a3/Activity%E4%B8%8EFragment%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%BA%8C.jpg">
<meta property="og:image" content="https://cl.ly/3cc83a0b5882/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BStandard.jpg">
<meta property="og:image" content="https://cl.ly/0ac3a2205759/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%A6%96%E9%A1%B5%E7%95%8C%E9%9D%A2.jpg">
<meta property="og:image" content="https://cl.ly/bb39f6fdcf92/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTop%E4%B8%80.jpg">
<meta property="og:image" content="https://cl.ly/0ac3a2205759/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%A6%96%E9%A1%B5%E7%95%8C%E9%9D%A2.jpg">
<meta property="og:image" content="https://cl.ly/09ccf968647d/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTask%E4%B8%80.jpg">
<meta property="og:image" content="https://cl.ly/99af625a0aff/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTask%E4%BA%8C.jpg">
<meta property="og:image" content="https://cl.ly/83ac2cff18f9/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTask%E6%A0%88%E4%BF%A1%E6%81%AF%E4%BA%8C.jpg">
<meta property="og:image" content="https://cl.ly/fbe4e5a510ec/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTask%E6%A0%88%E4%BF%A1%E6%81%AF%E4%B8%80.jpg">
<meta property="og:image" content="https://cl.ly/83ac2cff18f9/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTask%E6%A0%88%E4%BF%A1%E6%81%AF%E4%BA%8C.jpg">
<meta property="og:image" content="https://cl.ly/f4bd3c9750dc/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTask%E6%A0%88%E4%BF%A1%E6%81%AF%E4%B8%89.jpg">
<meta property="og:image" content="https://cl.ly/7af17b3f8e93/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTask%E5%9B%9B.jpg">
<meta property="og:image" content="https://cl.ly/88f335a5c071/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTask%E6%A0%88%E4%BF%A1%E6%81%AF%E5%9B%9B.jpg">
<meta property="og:image" content="https://cl.ly/28032465c79b/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeInstance.jpg">
<meta property="og:updated_time" content="2018-12-12T09:13:17.146Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="四大组件之Activity">
<meta name="twitter:description" content="参考：Android 四大组件 参考：开发艺术探索书籍 Activity 生命周期 正常启动流程：  onCreate() —— onStart() —— onResume()  正常销毁流程：  onPause() —— onStop() —— onDestroy() 操作情况： 1.处于 onResume() 的时候，用户按 Home 键或锁屏或打开新界面时，导致界面不可见，会回调 onPau">
<meta name="twitter:image" content="https://cl.ly/160503654da8/Activity%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/11/28/android/base/四大组件之Activity/"/>





     <title> 四大组件之Activity | FandaCode </title>
</head>




<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  
  
  <div class="bg_content">
    <div class="filter"></div>
    <canvas id="canvas"></canvas>
  </div>
 <script src="js/src/jquery.min.js"></script>
  
  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
	<a href="https://github.com/fandazeng" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; left: 0; transform: scale(-1, 1);" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style></a>    
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">FandaCode</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">IT相关技术</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user-circle-o"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>
	

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/11/28/android/base/四大组件之Activity/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Fanda">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="FandaCode">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">四大组件之Activity</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-11-28T10:42:59+08:00">
                2018-11-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android/" itemprop="url" rel="index">
                    <span itemprop="name">android</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android/入门/" itemprop="url" rel="index">
                    <span itemprop="name">入门</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2018/11/28/android/base/四大组件之Activity/" class="leancloud_visitors" data-flag-title="四大组件之Activity">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>参考：<a href="https://www.jianshu.com/p/51aaa65d5d25?tdsourcetag=s_pctim_aiomsg" target="_blank" rel="external">Android 四大组件</a></p>
<p>参考：开发艺术探索书籍</p>
<h1 id="Activity-生命周期"><a href="#Activity-生命周期" class="headerlink" title="Activity 生命周期"></a>Activity 生命周期</h1><p><img src="https://cl.ly/160503654da8/Activity%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F.jpg" alt=""></p>
<p>正常启动流程： </p>
<p>onCreate() —— onStart() —— onResume() </p>
<p>正常销毁流程： </p>
<p>onPause() —— onStop() —— onDestroy()</p>
<p>操作情况：</p>
<p>1.处于 onResume() 的时候，用户按 Home 键或锁屏或打开新界面时，导致界面不可见，会回调 onPause() —— onStop() ,这里有<br>一种特殊情况，如果新打开的界面采用了透明主题，那么当前的 Activity 只回调 onPause() 不回调 onStop()</p>
<p>2.处于 onPause() 的时候，用户操作使界面回到前台时，直接回调 onResume()</p>
<p>3.处于 onStop() 的时候，用户操作使界面重新可见时，回调 onRestart() —— onStart() —— onResume()</p>
<p>4.处于 onPause() 或 onStop() 的时候 ，界面被回收了，会重新走周期流程 onCreate() —— onStart() —— onResume() </p>
<p>异常销毁流程：</p>
<p>当系统资源配置发生改变（屏幕旋转）以及系统内存不足时，activity 被杀死。</p>
<p>情况1（系统资源配置发生改变（屏幕旋转))：</p>
<p>onCreate() —— onStart() —— onResume() ，此时屏幕旋转 ，会回调 onPause() —— onSaveInstanceState() —— onStop() —— onDestroy() —— onCreate() —— onStart() ——  onRestoreInstanceState() ——onResume() </p>
<p>由回调流程可知，系统配置改变时，界面会先销毁，而且会回调一个 onSaveInstanceState() 来保存当前的界面状态，这个方法一事实上在 onStop() 之前，但是与 onPause() 没既定顺序（但是测试的时候一直都在 onPause() 之后调用），界面销毁后会重新创建，并会在 onResume() 之前回调一个 onRestoreInstanceState() 方法，用于恢复异常时保存的数据。</p>
<p>情况2（内存不足导致低优先级的Activity被杀死)：</p>
<p>流程跟情况1是一样的。Activity 优先级从高到低如下：<br>1.处于 onResume（）时<br>2.处于 onPause() 时<br>3.处于 onStop（）时</p>
<p>使 Activity 处于各种生命周期的情况多变，我们只关注此时 Activity 正处于什么状态，就能知道此时的优先级了。</p>
<p>注意：</p>
<p> 1.旧 Activity 先 onPause() ，然后新 Activity 再启动，在新 Activity 回调到 onResume() 时，旧 Activity 才会回调 onStop（），所以在  onPause() 里可以做一些回收资源的操作，但是不能耗时，不然会影响到新 Activity 显示。在onStop（）里也可以做一些回收资源的操作，同样也不能太耗时。最好在 onStop（）或 onDestroy() 做资源回收，这样会使新界面尽快显示。</p>
<h2 id="Activity缓存方法。"><a href="#Activity缓存方法。" class="headerlink" title="Activity缓存方法。"></a>Activity缓存方法。</h2><p>场景1： 从 A 界面 打开 B 界面，此时 A 界面处于 onStop() ,很长时间后 A 界面可能因为优先级过低而被回收掉，此时从 B 界面返回到 A 界面时，将不会出现 onRestart() —— onStart() —— onResume() 这样的生命周期，而是 onCreate() —— onStart() —— onResume() 的正常生命周期，那么这会导致 A 界面数据和状态的丢失。</p>
<p>场景2： 在处于 A界面的时候，按下 Home 键或锁屏 ，些时 A 界面处于 onStop() ，此时恢复情况和场景1一样，其实原理一样，只是不同的操作导致界面处于优先级低的 onStop() 状态。</p>
<p>解决办法： </p>
<p>在上面两种场景下，界面从 onResume() 到 onStop() 中 ，会调用 onSaveInstanceState() 方法，即 A 界面会经历 onPause() —— onSaveInstanceState() —— onStop() ，我们可以利用 onSaveInstanceState() 回调方法保存临时数据和状态 ，之后我们可以通过 onCreate() 或 onRestoreInstanceState() 方法获取到之前保存的数据。至于要在哪个方法里做恢复数据处理，这取决于你要在什么时机， onRestoreInstanceState() 是在 onStart() 之后 ，onResume() 之前回调的。</p>
<pre><code>@Override
protected void onSaveInstanceState(Bundle outState) {
    super.onSaveInstanceState(outState);
    outState.putString(&quot;key&quot;,&quot;恢复数据&quot;);
    Logger.d(&quot;onSaveInstanceState&quot;+ &quot;===&quot; +TAG);
}

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    //如果不是因为异常情况导致重新创建，则为Null
    if (savedInstanceState != null) {
        mNavigation.setText(savedInstanceState.getString(&quot;key&quot;));
    }
}

@Override
protected void onRestoreInstanceState(Bundle savedInstanceState) {
    super.onRestoreInstanceState(savedInstanceState);
     //这里不用判空，如果回调了这个方法，一定不为Null
     mNavigation.setText(savedInstanceState.getString(&quot;key&quot;));
}
</code></pre><h2 id="onSaveInstanceState-Bundle-outState"><a href="#onSaveInstanceState-Bundle-outState" class="headerlink" title="onSaveInstanceState (Bundle outState)"></a>onSaveInstanceState (Bundle outState)</h2><p>不是每次回调 onStop() 之前都会回调这个方法的，是当 Activity 变得“容易”被系统销毁时，该 Activity 的 onSaveInstanceState 才会被回调。</p>
<p>不被回调的情况：<br>1.当用户主动按下返回键或通过点击界面的操作使 Activity 销毁了，不会回调该方法。</p>
<p>被回调的情况：<br>1.按下 HOME 键或锁屏，即之前的场景2<br>2.长按 HOME 键，选择运行其他的程序<br>3.从旧的 Activity 中启动一个新的 Activity 时,即之前的场景1<br>4.屏幕旋转，一定会回调</p>
<p>总结：除非你主动销毁界面，否则都会回调该方法，这是系统的责任，因为它必须要提供一个机会让你保存你的数据（当然你不保存那就随便你了）。</p>
<p>注意：<br>1.布局中的每一个 View 默认实现了 onSaveInstanceState 和 onRestoreInstanceState 方法，View 会自动地存储和在 Activity 重新创建的时候自动地恢复。但是这种情况只有在你为这个View提供了唯一的ID之后才起作用。</p>
<p>2.虽然 View 中实现了该方法，但是如果你的自定义 View 需要存储额外的状态信息，那么你应该覆盖该方法。</p>
<p>3.不要在该方法中存储持久化的数据，因为这个方法在用户主动销毁时不会调用，应该在 onPause()方法中存储持久化数据。</p>
<p>二、onRestoreInstanceState (Bundle outState)</p>
<p>onSaveInstanceState() 方法和 onRestoreInstanceState() 方法“不一定”是成对的被调用的，因为 onSaveInstanceState() 是在可能发生界面被回收时给你保存数据用的，这是系统的责任，上面已经说得很清楚，而如果界面没有被回收，那么 onRestoreInstanceState() 也就不会出现了。</p>
<h2 id="onConfigurationChanged-Configuration-newConfig-方法"><a href="#onConfigurationChanged-Configuration-newConfig-方法" class="headerlink" title="onConfigurationChanged(Configuration newConfig) 方法"></a>onConfigurationChanged(Configuration newConfig) 方法</h2><p>当系统的配置信息发生改变时，系统会调用此方法。注意，只有在清单文件 AndroidManifest 中处理了 configChanges 属性对应的设备配置，该方法才会被调用。如果发生设备配置与在清单文件中设置的不一致，则Activity会被销毁并使用新的配置重建。</p>
<p>上面说的旋转屏幕时，Activity 会先销毁，然后重新创建，但是如果想防止重新创建 Activity ，可以配置 configChange 属性，比如：</p>
<pre><code>&lt;activity 
       android:name=&quot;.MainActivity&quot; 
       android:configChanges=&quot;orientation|screenSize&quot;&gt;
</code></pre><p>此时 Activity 不会被销毁重建，而是调用 onConfigurationChanged 方法。如果 configChanges 只设置了orientation ，则当其他设备配置信息改变时，Activity 依然会销毁重建，且不会调用 onConfigurationChanged 。比如语言改变了，Acitivyt 就会销毁重建，且不会调用 onConfigurationChanged  方法。</p>
<pre><code>@Override
public void onConfigurationChanged(Configuration newConfig) {
    super.onConfigurationChanged(newConfig);
    Logger.d(&quot;onConfigurationChanged&quot;+ &quot;===&quot; +TAG);
}
</code></pre><p>注意：<br>1.横竖屏切换的属性是 orientation 。如果 targetSdkVersion 的值大于等于13，则如上配置才会回调 onConfigurationChanged 方法，要带上 screenSize 属性。</p>
<p>2.当我们需要在界面旋转时，可以在该方法做一些特殊处理，比如视频播放横竖屏切换时，可以通过 newConfig.orientation 根据方向做界面处理。</p>
<h2 id="Activity与Fragment生命周期关系"><a href="#Activity与Fragment生命周期关系" class="headerlink" title="Activity与Fragment生命周期关系"></a>Activity与Fragment生命周期关系</h2><p><img src="https://cl.ly/6c1701ef073d/Activity%E5%92%8CFragment%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%85%B3%E7%B3%BB.png" alt=""></p>
<p><img src="https://cl.ly/f99b84656e1d/Activity%E4%B8%8EFragment%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%B8%80.jpg" alt=""></p>
<p><img src="https://cl.ly/a8180a2dd6a3/Activity%E4%B8%8EFragment%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%BA%8C.jpg" alt=""></p>
<h2 id="Activity启动模式"><a href="#Activity启动模式" class="headerlink" title="Activity启动模式"></a>Activity启动模式</h2><h3 id="任务栈"><a href="#任务栈" class="headerlink" title="任务栈"></a>任务栈</h3><p>是一种后进先出的结构。位于栈顶的 Activity 处于焦点状态,当按下 back 按钮的时候,栈内的 Activity 会一个一个的出栈,并且调用其 onDestory() 方法。如果栈内没有 Activity ,那么系统就会回收这个栈,每个应用默认只有一个栈,以应用的包名来命名。</p>
<h3 id="standard-模式（默认）"><a href="#standard-模式（默认）" class="headerlink" title="standard 模式（默认）"></a>standard 模式（默认）</h3><p>系统默认的启动模式，每次启动一个 Activity 都会重新创建一个新的实例，不管这个实例存在与否，这种模式下，谁启动了该模式的 Activity ，该 Activity 就属于启动它的 Activity 的任务栈中。 Activity 的启动三回调(onCreate()-&gt;onStart()-&gt;onResume())都会执行。</p>
<p>清单文件配置如下：</p>
<pre><code>&lt;activity android:name=&quot;.activity.StandardModeActivity&quot;  android:launchMode=&quot;standard&quot;/&gt;
</code></pre><p>使用案例：从一个主界面，打开一个 Standard 模式的界面，在该界面再次打开该界面。</p>
<p>案例打印的日志如下：</p>
<p><img src="https://cl.ly/3cc83a0b5882/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BStandard.jpg" alt=""></p>
<p>日志分析：</p>
<p>系统先创建了 MainLaunchModeActivity ，该界面的 taskAffinity 是 zeng.fanda.com.fourmoduledemo ，taskId 是 753 ，然后再创建了两次 StandardModeActivity ，而且 taskAffinity 和 taskId 都跟 MainLaunchModeActivity 的一样。<br>结合上述 standard 模式的描述，由于 MainLaunchModeActivity 启动了 StandardModeActivity ，所以 StandardModeActivity 就属于 MainLaunchModeActivity 的任务栈，再次打开的 StandardModeActivity 就属于原 StandardModeActivity 的任务栈，所以三个界面的任务栈是一样的。而且每个 Activity 的 hashCode 都是不一样，说明他们都是不同的实例，即每次启动都会重新创建一个新实例。onCreate()-&gt;onStart()-&gt;onResume()都会执行，日志里没做打印而已。</p>
<h3 id="singleTop-模式"><a href="#singleTop-模式" class="headerlink" title="singleTop 模式"></a>singleTop 模式</h3><p>这个模式分3种情况。第一，Activity 没创建过，此时打开该模式的 Activity 就跟 Standard 模式一模一样。第二，Activity 创建了，但是不在栈顶，也跟 Standard 模式一模一样。第三，当 Activity 处于栈顶，此时再次打开该模式的 Activity ，该 Activity 不会重新创建实例，直接复用，而且不会调用 onCreate() 和 onStart() ，但是会执行 onNewIntent(Intent intent) 和 onResume() 方法。</p>
<p>清单文件配置如下：</p>
<pre><code>&lt;activity android:name=&quot;.activity.SingleTopModeActivity&quot;  android:launchMode=&quot;singleTop&quot;/&gt;
</code></pre><p>使用案例：从一个主界面，打开一个 singleTop 模式的界面，在该界面多次打开该界面。</p>
<p>案例打印的日志如下：</p>
<p><img src="https://cl.ly/0ac3a2205759/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%A6%96%E9%A1%B5%E7%95%8C%E9%9D%A2.jpg" alt=""></p>
<p><img src="https://cl.ly/bb39f6fdcf92/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTop%E4%B8%80.jpg" alt=""></p>
<p>日志分析：</p>
<p>因为上述的第一种情况包括了第二种情况，所以这里只分析第一和第三种情况。系统先创建了 MainLaunchModeActivity ，该界面的 taskAffinity 是 zeng.fanda.com.fourmoduledemo ，taskId 是 760 ，然后再创建了SingleTopModeActivity ，而且 taskAffinity 和 taskId 都跟 MainLaunchModeActivity 的一样。结合上述 singleTop 模式的描述，该模式还是属于打开它的 Activity 的任务栈，因为第一次创建时 SingleTopModeActivity 不存在，所以onCreate()-&gt;onStart()-&gt;onResume()都会执行, hashCode 不一样，证实是创建了一个新实例，这跟 Standard 模式一样。之后多次打开该界面时，走了 onNewIntent()-&gt;onResume() 回调，而且 taskId 和 hashCode 都没变，证明还是处于同一个栈内且没创建新实例，直接复用原有的实例。</p>
<p>总结一下：只要该模式的界面不在栈顶，流程都跟 Standard 模式一样，不管实例存在与否，只有处于栈顶时，流程才会不一样。</p>
<h3 id="taskAffinity-属性"><a href="#taskAffinity-属性" class="headerlink" title="taskAffinity 属性"></a>taskAffinity 属性</h3><p>这里先说明一下 taskAffinity 这个属性。 taskAffinity 可以简单的理解为任务相关性。</p>
<ul>
<li><p>这个参数标识了一个 Activity 所需任务栈的名字，默认情况下，所有 Activity 所需的任务栈的名字为应用的包名。上述日志打印的 taskAffinity 的值 (zeng.fanda.com.fourmoduledemo) 就是我的包名。</p>
</li>
<li><p>我们可以单独指定每一个 Activity 的 taskAffinity 属性来覆盖默认值</p>
</li>
<li><p>在概念上，具有相同的 affinity 的 activity（即设置了相同 taskAffinity 属性的activity）属于同一个任务栈</p>
</li>
<li><p>为一个 activity 的 taskAffinity 设置一个空字符串，表明这个 activity 不属于任何任务栈</p>
</li>
</ul>
<p>注意： taskAffinity 属性主要和 singleTask 启动模式或者 allowTaskReparenting 属性配对使用，在其他情况下没有意义。所以即使上述两种模式下设置了该属性，也不会创建新的任务栈，只是名字不同罢了。指定方式如下：</p>
<pre><code>&lt;activity android:name=&quot;.activity.MainLaunchModeActivity&quot; 
    android:configChanges=&quot;orientation|screenSize&quot; 
    android:taskAffinity=&quot;zeng.fanda.com.fourmoduledemo.launch&quot;&gt;
</code></pre><h3 id="singleTask-模式"><a href="#singleTask-模式" class="headerlink" title="singleTask 模式"></a>singleTask 模式</h3><p>栈内复用模式，这是一种栈内单例模式，不同的栈内可以存在不同的实例。创建这种模式的 Activity 的时候,系统会先确认它所需任务栈是否已经创建,否则先创建任务栈（任务栈通过 taskAffinity 体内体内指定）.然后放入 Activity ,如果所需的栈已经存在而且已经有一个 Activity 实例,那么这个 Activity 就会被复用,会将当前 Activity 上面所有的 Activity 出栈，并且会回调 onNewIntent()-&gt;onResume() 。</p>
<p>清单文件配置如下：</p>
<pre><code>&lt;activity android:name=&quot;.activity.SingleTaskModeActivity&quot;  android:launchMode=&quot;singleTask&quot;/&gt;
</code></pre><p>使用案例一：从一个主界面，打开一个 singleTask 模式的界面，在该界面再次打开该界面。</p>
<p>案例打印的日志如下：</p>
<p><img src="https://cl.ly/0ac3a2205759/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8B%E9%A6%96%E9%A1%B5%E7%95%8C%E9%9D%A2.jpg" alt=""></p>
<p><img src="https://cl.ly/09ccf968647d/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTask%E4%B8%80.jpg" alt=""></p>
<p>这种情况跟 SingleTop 模式一样的流程，无需过多分析。</p>
<p>使用案例二：从一个主界面，打开一个 singleTask 模式的界面 SingleTaskModeActivity ，在该界面再打开另一个 singleTask 模式的界面 OtherTaskModeActivity ，最后在 OtherTaskModeActivity 打开之前的 SingleTaskModeActivity 。</p>
<p>案例打印的日志如下：</p>
<p><img src="https://cl.ly/99af625a0aff/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTask%E4%BA%8C.jpg" alt=""></p>
<p>这里我们只关注 OtherTaskModeActivity 跳回 SingleTaskModeActivity 时的情况，由图可知，SingleTaskModeActivity 回调了 onNewIntent()-&gt;onStart()-&gt;onResume() 。由于是从不可见到可见，所以这里比 SingleTop 模式多回调 onStart()。此时栈内应该只有两个实例，因为 OtherTaskModeActivity 会被出栈，我们使用命令 adb shell dumpsys activity activities 查看一下：</p>
<p>当没跳回到 SingleTaskModeActivity 时，栈内信息如下：</p>
<p><img src="https://cl.ly/83ac2cff18f9/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTask%E6%A0%88%E4%BF%A1%E6%81%AF%E4%BA%8C.jpg" alt=""></p>
<p>跳回到 SingleTaskModeActivity 时，栈内信息如下：</p>
<p><img src="https://cl.ly/fbe4e5a510ec/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTask%E6%A0%88%E4%BF%A1%E6%81%AF%E4%B8%80.jpg" alt=""></p>
<p>使用案例：在案例二的基础上，指定 SingleTaskModeActivity 的 taskAffinity 值。</p>
<pre><code>&lt;activity android:name=&quot;.activity.SingleTaskModeActivity&quot;  
    android:launchMode=&quot;singleTask&quot; 
    android:taskAffinity=&quot;zeng.fanda.com.fourmoduledemo.singletop&quot;/&gt;
</code></pre><p>案例打印的日志如下：</p>
<p>当没跳回到 SingleTaskModeActivity 时，日志信息和栈内信息如下：</p>
<p><img src="https://cl.ly/83ac2cff18f9/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTask%E6%A0%88%E4%BF%A1%E6%81%AF%E4%BA%8C.jpg" alt=""></p>
<p><img src="https://cl.ly/f4bd3c9750dc/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTask%E6%A0%88%E4%BF%A1%E6%81%AF%E4%B8%89.jpg" alt=""></p>
<p>日志分析： SingleTaskModeActivity 的 TaskId 和 taskAffinity 跟 MainLaunchModeActivity 的不一样了，说明新开启了一个任务栈 SingleTaskModeActivity 放在了一个新栈上面。因为 因为OtherTaskModeActivity 没指定 taskAffinity 属性，所以OtherTaskModeActivity 的 TaskId 和 taskAffinity 跟 MainLaunchModeActivity 的一样，说明没建新的任务栈，放在了 MainLaunchModeActivity 所处的栈上面了。栈内信息充分说明了这一点。</p>
<p>当跳回到 SingleTaskModeActivity 时，日志信息和栈内信息如下：</p>
<p><img src="https://cl.ly/7af17b3f8e93/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTask%E5%9B%9B.jpg" alt=""></p>
<p><img src="https://cl.ly/88f335a5c071/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeTask%E6%A0%88%E4%BF%A1%E6%81%AF%E5%9B%9B.jpg" alt=""></p>
<p>日志分析：跳回到 SingleTaskModeActivity 时，回调了 SingleTaskModeActivity 的 onNewIntent() 方法，但是 OtherTaskModeActivity 没有出栈 ，因为 SingleTaskModeActivity 是在一个新栈上面的，且栈内只有它一个实例。即 793 栈 有 MainLaunchModeActivity 和 OtherTaskModeActivity ，794 栈有 SingleTaskModeActivity ，这个操作只是从 793 的 OtherTaskModeActivity 切换到了794栈的 SingleTaskModeActivity 。</p>
<h3 id="singleInstance-模式"><a href="#singleInstance-模式" class="headerlink" title="singleInstance 模式"></a>singleInstance 模式</h3><p>该模式具备 singleTask 模式的所有特性外，与它的区别就是，这种模式下的 Activity 会单独占用一个任务栈，具有全局唯一性，即整个系统中就这么一个实例，由于栈内复用的特性，后续的请求均不会创建新的 Activity 实例，除非这个特殊的任务栈被销毁了。以 singleInstance 模式启动的 Activity 在整个系统中是单例的，如果在启动这样的 Activiyt 时，已经存在了一个实例，那么会把它所在的任务调度到前台，重用这个实例。</p>
<p>使用案例：：从 A 应用的一个主界面，打开一个 singleInstance 模式的界面 SingleTaskInstanceActivity ，在 B 应用再打开该界面。即分别在两个应用打开同一个 singleInstance 模式的界面 。</p>
<p>配置信息：</p>
<pre><code>&lt;activity android:name=&quot;.activity.SingleInstanceModeActivity&quot;  android:launchMode=&quot;singleInstance&quot;&gt;
    &lt;intent-filter&gt;
        &lt;action android:name=&quot;zeng.fanda.com.fourmoduledemo.singleinstance&quot;/&gt;
        &lt;category android:name=&quot;android.intent.category.DEFAULT&quot;/&gt;
</code></pre><p>日志信息如下：</p>
<p><img src="https://cl.ly/28032465c79b/Activity%E5%90%AF%E5%8A%A8%E6%A8%A1%E5%BC%8F%E4%B9%8BSinlgeInstance.jpg" alt=""></p>
<p>日志分析：</p>
<p>A应用的主界面的 TaskId 是 809 ， SingleInstanceModeActivity 的 TaskId 是 810 ，证明为SingleInstanceModeActivity 新建了一个任务栈 。B应用的主界面的 TaskId 是 811 ，在B应用打开 SingleInstanceModeActivity 时，回调了 onNewIntent ,且 TaskId 是 810 ，证明SingleInstanceModeActivity 被调到前台重用了，没有新建任务栈和新建实例，具有系统全局唯一性。</p>
<h3 id="配合-allowTaskReparenting-使用"><a href="#配合-allowTaskReparenting-使用" class="headerlink" title="配合 allowTaskReparenting 使用"></a>配合 allowTaskReparenting 使用</h3><pre><code>android:allowTaskReparenting=&quot;true&quot;
</code></pre><p>当应用A启动应用B的某个 Activity 后，如果这个 Activity 设置了该属性，那么当B应用启动后，该 Activity 会从应用A的任务栈转移到应用B的任务栈中。具体一点，A应用启动了B的界面，B的界面此时应该放在启动它的应用A的任务栈里，当B应用启动后，B的任务栈就生成了，界面检测到了之后，就不放在A应用了，转移到自己的应用的任务栈里，所以打开B应用后，会看到从A应用打开的界面。这个效果比较特殊。</p>
<h3 id="前后台任务栈"><a href="#前后台任务栈" class="headerlink" title="前后台任务栈"></a>前后台任务栈</h3><p>前台任务栈表示该任务栈正在前台，比如前台任务栈里有 A-B 三个界面。后台任务栈中的界面位于暂停状态，用户可以通过切换将后台任务栈再次调到前台，比如后台任务栈里有 C-D 两个界面 。现在从前台任务栈请求D界面，此时整个后台任务栈将切换到前台，如果此时返回，将从D返回到C 界面，C再返回B，B再返回A。即前台任务栈的界面全部出栈后，后台任务栈再切到前台继续出栈。</p>
<h3 id="Activity-启动模式的使用场景"><a href="#Activity-启动模式的使用场景" class="headerlink" title="Activity 启动模式的使用场景"></a>Activity 启动模式的使用场景</h3><ol>
<li><p>SingleTask 模式的运用场景，最常见的应用场景就是保持我们应用开启后仅仅有一个Activity 的实例。最典型的样例就是应用中展示的主页（Home页）。</p>
</li>
<li><p>SingleTop模式的运用场景，假设你在当前的 Activity 中又要启动同类型的 Activity，此时建议将此类型 Activity 的启动模式指定为 SingleTop，能够降低 Activity 的创建，节省内存！</p>
</li>
</ol>
<p>注意：由于当一个 Activity 设置了 SingleTop 或者 SingleTask 模式后，跳转此 Activity 出现复用原有 Activity 的情况时，此 Activity 的 onCreate 方法将不会再次运行。 onCreate 方法仅仅会在第一次创建 Activity 时被运行。这时我们要在另外一个回调 onNewIntent（Intent intent）方法中做处理。</p>
<pre><code>@Override
protected void onNewIntent(Intent intent) {
    super.onNewIntent(intent);
    setIntent(intent);
    //数据处理
}
</code></pre><h3 id="Activity-的-Flags"><a href="#Activity-的-Flags" class="headerlink" title="Activity 的 Flags"></a>Activity 的 Flags</h3><ul>
<li>FLAG_ACTIVITY_NEW_TASK</li>
</ul>
<p>作用是为 Activity 指定 “SingleTask” 启动模式。效果和在 AndroidMainfest.xml 指定相同。</p>
<ul>
<li>FLAG_ACTIVITY_SINGLE_TOP</li>
</ul>
<p>作用是为 Activity 指定 “SingleTop” 启动模式，效果和在 AndroidMainfest.xml 指定相同。</p>
<ul>
<li>FLAG_ACTIVITY_CLEAR_TOP</li>
</ul>
<p>具有此标记位的 Activity ，启动时会将与该 Activity 在同一任务栈的其他 Activity 出栈。一般与 SingleTask 启动模式一起出现。 SingleTask 启动模式默认具有此标记位的作用。</p>
<p>总结：Flags 方便动态打开 Activity 时实现这些效果，比如我们打开第三方 Activity 时，我们可以加上这些 Flags 来达到我们想要的效果。</p>
<h3 id="IntentFilter-的匹配规则"><a href="#IntentFilter-的匹配规则" class="headerlink" title="IntentFilter 的匹配规则"></a>IntentFilter 的匹配规则</h3><p>启动 Activity 分为显式调用和隐式调用，隐式调用需要 Intent 能够匹配目标组件的 IntentFilter 中所设置的过滤信息，如果不匹配将无法启动目标 Activity。 IntentFilter 中的过滤信息有 action 、 category 和 data 。</p>
<p>为了匹配过滤列表，需要同时匹配列表中的 action 、 category 、data信息，否则匹配失败。 action 、 category 、data 都可以有多个，IntentFilter 也可以有多个，一个 Intent 只要能匹配任何一组 intent-filter 即可成功启动对应的 Activity 。</p>
<h4 id="action-匹配规则"><a href="#action-匹配规则" class="headerlink" title="action 匹配规则"></a>action 匹配规则</h4><p>Intent 中的 action 存在且必须和过滤规则中的其中一个 action 相同即可匹配成功。action 区分大小写，大小写不同会导致匹配失败。虽然过滤规则中可以有多个 action ，但是 Intent 中的设置的 action 只有一个，方法是 intent.setAction()。Intent中 没有指定 action ，也会匹配失败。</p>
<h4 id="category-匹配规则"><a href="#category-匹配规则" class="headerlink" title="category 匹配规则"></a>category 匹配规则</h4><p>Intent 中可以不添加 category ，系统会默认为 Intent 添加 上 “android.intent.category.DEFAULT” 这个 category。Intent 中可以添加多个 category ，方法是 intent.addCategory()，添加的 category 在过滤规则中都必须存在，有一个不存在或不相同，都会匹配失败</p>
<h4 id="data-匹配规则"><a href="#data-匹配规则" class="headerlink" title="data 匹配规则"></a>data 匹配规则</h4><p>data 的结构如下：</p>
<pre><code>&lt;data
    android:host=&quot;string&quot;
    android:mimeType=&quot;string&quot;
    android:path=&quot;string&quot;
    android:pathPattern=&quot;string&quot;
    android:pathPrefix=&quot;string&quot;
    android:port=&quot;string&quot;
    android:scheme=&quot;string&quot; /&gt;
</code></pre><p>data 由两部分组成，mimeType 和 URL ，mineType 指媒体类型，比如 image/jpeg 、 video/* 等，可以表示图片、视频等不同的媒体格式，而URI 中包含的数据比较多，URI结构如下：</p>
<pre><code>&lt;scheme&gt;://&lt;host&gt;:&lt;port&gt;/[&lt;path&gt;|&lt;pathPrefix&gt;|&lt;pathPattern&gt;]
</code></pre><p>比如：</p>
<pre><code>content://zeng.fanda.com.fourmoduledemo.provider.PersonProvider/person

http://www.baidu.com:80/search/info
</code></pre><p>scheme: URI 的模式，比如 http、file、content 等，如果没有指定，整个URI都是无效了。</p>
<p>host: URI 的主机名，比如 www.baidu.com ，如果没有指定，整个URI都是无效了。</p>
<p>port: URI 的端口号，比如 80 ，仅当有 scheme 和 host 的情况下 ，才有意义。</p>
<p>path、pathPrefix、pathPattern： 表述路径信息，path 表示完整路径，pathPrefix 表示路径的前缀信息，pathPattern 也表示完整的路径信息，但是可以包含通配符*</p>
<p>匹配规则和 action 类似 ，Intent 中的 data 存在且必须和过滤规则中的其中一个 data 相同即可匹配成功。虽然过滤规则中可以有多个 data ，但是 Intent 中的设置的 data 只有一个，方法是 intent.setData()。如果过滤规则中有，但是Intent中没有指定 data ，也会匹配失败。</p>
<p>如果我们没有指定 URI ，系统会有默认值，URI 的默认值为 content 和file ，也就是说，Intent 中的 URI 部分的 scheme 必须为 content 或 file 才能匹配。比如 ：</p>
<pre><code>&lt;data android:mimeType=&quot;image/*&quot; /&gt;
</code></pre><p>如下调用方式会失败：</p>
<pre><code>intent.setDataAndType(Uri.parse(&quot;http://abc&quot;), &quot;image/jpg&quot;);
</code></pre><p>正确的调用方式为：</p>
<pre><code>intent.setDataAndType(Uri.parse(&quot;content://abc&quot;), &quot;image/jpg&quot;);
</code></pre><p>注意： </p>
<ul>
<li><p>如果为 Intent 指定完整的 data ，必须调用 setDataAndType 方法，不能先调用 setData 再调用 setType ，这两个方法会清除对方的值。</p>
</li>
<li><p>当隐式调用时，可能会找不到相应的组件，这时候会报错，所以我们可以先做一下判断，看是否有组件能够匹配到，匹配到才做相应处理。Intent 的 resolveActivity() 方法可以做到，方法返回 null 则表示没找到匹配的，代码示例如下：</p>
<pre><code>Intent intent = new Intent();
intent.setAction(&quot;abc&quot;);
intent.setDataAndType(Uri.parse(&quot;content://abc&quot;), &quot;image/jpg&quot;);
if (intent.resolveActivity(getPackageManager()) != null) {
    startActivity(intent);
}
</code></pre></li>
<li><p>有一类 action 和 category 比较特殊，是用来标明这是一个入口 Activity 并且会出现在系统的应用列表中，少了任何一个都没有意义，他们是：</p>
<pre><code>&lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;

&lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;
</code></pre></li>
</ul>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/android/" rel="tag"><i class="fa fa-tag"></i> android</a>
          
            <a href="/tags/基础/" rel="tag"><i class="fa fa-tag"></i> 基础</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/10/31/android/view/View属性动画/" rel="next" title="View 属性动画">
                <i class="fa fa-chevron-left"></i> View 属性动画
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/12/03/android/base/四大组件之Service/" rel="prev" title="四大组件之Service">
                四大组件之Service <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
	  <div id="gitalk-container"></div>   
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/uploads/images/avatar.jpg"
               alt="Fanda" />
          <p class="site-author-name" itemprop="name">Fanda</p>
           
              <p class="site-description motion-element" itemprop="description">IT相关技术</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">32</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/fandazeng" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://github.com/fandazeng" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                  Weibo
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://github.com/fandazeng" target="_blank" title="掘金">
                  
                    <i class="fa fa-fw fa-group"></i>
                  
                  掘金
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://github.com/fandazeng" target="_blank" title="JianShu">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  JianShu
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Activity-生命周期"><span class="nav-number">1.</span> <span class="nav-text">Activity 生命周期</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Activity缓存方法。"><span class="nav-number">1.1.</span> <span class="nav-text">Activity缓存方法。</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#onSaveInstanceState-Bundle-outState"><span class="nav-number">1.2.</span> <span class="nav-text">onSaveInstanceState (Bundle outState)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#onConfigurationChanged-Configuration-newConfig-方法"><span class="nav-number">1.3.</span> <span class="nav-text">onConfigurationChanged(Configuration newConfig) 方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Activity与Fragment生命周期关系"><span class="nav-number">1.4.</span> <span class="nav-text">Activity与Fragment生命周期关系</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Activity启动模式"><span class="nav-number">1.5.</span> <span class="nav-text">Activity启动模式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#任务栈"><span class="nav-number">1.5.1.</span> <span class="nav-text">任务栈</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#standard-模式（默认）"><span class="nav-number">1.5.2.</span> <span class="nav-text">standard 模式（默认）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#singleTop-模式"><span class="nav-number">1.5.3.</span> <span class="nav-text">singleTop 模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#taskAffinity-属性"><span class="nav-number">1.5.4.</span> <span class="nav-text">taskAffinity 属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#singleTask-模式"><span class="nav-number">1.5.5.</span> <span class="nav-text">singleTask 模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#singleInstance-模式"><span class="nav-number">1.5.6.</span> <span class="nav-text">singleInstance 模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#配合-allowTaskReparenting-使用"><span class="nav-number">1.5.7.</span> <span class="nav-text">配合 allowTaskReparenting 使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#前后台任务栈"><span class="nav-number">1.5.8.</span> <span class="nav-text">前后台任务栈</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity-启动模式的使用场景"><span class="nav-number">1.5.9.</span> <span class="nav-text">Activity 启动模式的使用场景</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Activity-的-Flags"><span class="nav-number">1.5.10.</span> <span class="nav-text">Activity 的 Flags</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IntentFilter-的匹配规则"><span class="nav-number">1.5.11.</span> <span class="nav-text">IntentFilter 的匹配规则</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#action-匹配规则"><span class="nav-number">1.5.11.1.</span> <span class="nav-text">action 匹配规则</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#category-匹配规则"><span class="nav-number">1.5.11.2.</span> <span class="nav-text">category 匹配规则</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#data-匹配规则"><span class="nav-number">1.5.11.3.</span> <span class="nav-text">data 匹配规则</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
	
	<div id="music163player">
		<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=38358214&auto=0&height=66"></iframe>
	</div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-Fanda"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Fanda</span>
</div>

<div>
<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<span id="busuanzi_container_site_pv" style='display:none'>
    本站总访问量 <span id="busuanzi_value_site_pv"></span> 次
    <span class="post-meta-divider">|</span>
</span>
<span id="busuanzi_container_site_uv" style='display:none'>
    有<span id="busuanzi_value_site_uv"></span>人看过我的博客啦
</span>
</div>




        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/canvasline.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/baidu_tools.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>


  


  




	





  





  





  






  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
  <script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
   <script type="text/javascript">
        var gitalk = new Gitalk({
          clientID: '0a24ec23db863f69c94e',
          clientSecret: '454d8ed43ceaa65490b7a854f7cef0b95b7e3be6',
          repo: 'fandazeng.github.io',
          owner: 'fandazeng',
          admin: ['fandazeng'],
          id: md5(location.pathname),
          distractionFreeMode: 'true'
        })
        gitalk.render('gitalk-container')           
       </script>

  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("eROyoFH3H91PrCEieToSBnny-gzGzoHsz", "D5CAVRJl32bxjAlfHhdpWlAA");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  


</body>
</html>